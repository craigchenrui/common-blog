!function(d,c){"undefined"!=typeof module&&module.exports?module.exports=c(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(b){return c(b)}):c(d.jQuery)}(this,function(e){var d=function(a,g){this.$element=e(a),this.options=e.extend({},e.fn.typeahead.defaults,g),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=e(this.options.menu),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:!1,this.afterSelect=this.options.afterSelect,this.addItem=!1};d.prototype={constructor:d,select:function(){var g=this.$menu.find(".active").data("value");if(this.$element.data("active",g),this.autoSelect||g){var c=this.updater(g);this.$element.val(this.displayText(c)||c).change(),this.afterSelect(c)}return this.hide()},updater:function(b){return b},setSource:function(b){this.source=b},show:function(){var a,g=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return a="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,(this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter(this.$element)).css({top:g.top+g.height+a,left:g.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(a){if(this.query="undefined"!=typeof a&&null!==a?a:this.$element.val()||"",this.query.length<this.options.minLength){return this.shown?this.hide():this}var g=e.proxy(function(){e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(g,this.delay)},process:function(a){var g=this;return a=e.grep(a,function(b){return g.matcher(b)}),a=this.sorter(a),a.length||this.options.addItem?(a.length>0?this.$element.data("active",a[0]):this.$element.data("active",null),this.options.addItem&&a.push(this.options.addItem),"all"==this.options.items?this.render(a).show():this.render(a.slice(0,this.options.items)).show()):this.shown?this.hide():this},matcher:function(g){var c=this.displayText(g);return ~c.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(h){for(var g,l=[],k=[],j=[];g=h.shift();){var i=this.displayText(g);i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?k.push(g):j.push(g):l.push(g)}return l.concat(k,j)},highlighter:function(r){var q,p,o,n,m,l=e("<div></div>"),k=this.query,a=r.toLowerCase().indexOf(k.toLowerCase());if(q=k.length,0===q){return l.text(r).html()}for(;a>-1;){p=r.substr(0,a),o=r.substr(a,q),n=r.substr(a+q),m=e("<strong></strong>").text(o),l.append(document.createTextNode(p)).append(m),r=n,a=r.toLowerCase().indexOf(k.toLowerCase())}return l.append(document.createTextNode(r)).html()},render:function(a){var i=this,h=this,g=!1;return a=e(a).map(function(c,k){var j=h.displayText(k);return c=e(i.options.item).data("value",k),c.find("a").html(i.highlighter(j)),j==h.$element.val()&&(c.addClass("active"),h.$element.data("active",k),g=!0),c[0]}),this.autoSelect&&!g&&(a.first().addClass("active"),this.$element.data("active",a.first().data("value"))),this.$menu.html(a),this},displayText:function(b){return b.name||b},next:function(){var a=this.$menu.find(".active").removeClass("active"),g=a.next();g.length||(g=e(this.$menu.find("li")[0])),g.addClass("active")},prev:function(){var g=this.$menu.find(".active").removeClass("active"),c=g.prev();c.length||(c=this.$menu.find("li").last()),c.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(g){var c=g in this.$element;return c||(this.$element.setAttribute(g,"return;"),c="function"==typeof this.$element[g]),c},move:function(b){if(this.shown){switch(b.keyCode){case 9:case 13:case 27:b.preventDefault();break;case 38:if(b.shiftKey){return}b.preventDefault(),this.prev();break;case 40:if(b.shiftKey){return}b.preventDefault(),this.next()}b.stopPropagation()}},keydown:function(a){this.suppressKeyPressRepeat=~e.inArray(a.keyCode,[40,38,9,13,27]),this.shown||40!=a.keyCode?this.move(a):this.lookup()},keypress:function(b){this.suppressKeyPressRepeat||this.move(b)},keyup:function(b){switch(b.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}b.stopPropagation(),b.preventDefault()},focus:function(){this.focused||(this.focused=!0,this.options.showHintOnFocus&&this.lookup(""))},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(b){b.stopPropagation(),b.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(a){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(a.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var f=e.fn.typeahead;e.fn.typeahead=function(b){var a=arguments;return"string"==typeof b&&"getActive"==b?this.data("active"):this.each(function(){var i=e(this),h=i.data("typeahead"),c="object"==typeof b&&b;h||i.data("typeahead",h=new d(this,c)),"string"==typeof b&&(a.length>1?h[b].apply(h,Array.prototype.slice.call(a,1)):h[b]())})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:e.noop,delay:0,addItem:!1},e.fn.typeahead.Constructor=d,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=f,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var a=e(this);a.data("typeahead")||a.typeahead(a.data())})});